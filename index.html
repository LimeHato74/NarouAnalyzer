<!DOCTYPE html>
<html lang="ja" data-theme="winter">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Narou Analyzer Pro - ãªã‚ã†ç³»Webå°èª¬ã®æ–‡ä½“ãƒ»å†…å®¹è©•ä¾¡ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ãƒ„ãƒ¼ãƒ«</title>
    <meta name="description" content="å°èª¬å®¶ã«ãªã‚ã†ç­‰ã®Webå°èª¬åŸ·ç­†è€…å‘ã‘ç„¡æ–™åˆ†æãƒ„ãƒ¼ãƒ«ã€‚ç•°ä¸–ç•Œã€ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã€æ‹æ„›ãªã©ã‚¸ãƒ£ãƒ³ãƒ«ã«åˆã‚ã›ã¦æ–‡ä½“ãƒªã‚ºãƒ ã€äº”æ„Ÿæå†™ã€æ„Ÿæƒ…æ›²ç·šã‚’AIãŒè‡ªå‹•æ¡ç‚¹ã€‚ãƒ–ãƒ©ã‚¦ã‚¶å®Œçµã§ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚‚å®‰å¿ƒã€‚">
    <meta name="keywords" content="ãªã‚ã†ç³»,å°èª¬åˆ†æ,æ¨æ•²,åŸ·ç­†ãƒ„ãƒ¼ãƒ«,æ„Ÿæƒ³AI,ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°,æ–‡ä½“è¨ºæ–­,æ–°äººè³">
    <meta property="og:title" content="Webå°èª¬åˆ†æãƒ„ãƒ¼ãƒ« - Narou Analyzer Pro">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-domain.com/">
    <meta property="og:image" content="https://your-domain.com/ogp.png">
    <meta property="og:description" content="ã‚ãªãŸã®å°èª¬ã‚’ã€Œãªã‚ã†åŸºæº–ã€ã§Sã€œCãƒ©ãƒ³ã‚¯åˆ¤å®šã€‚æ„Ÿæƒ…ã®èµ·ä¼ã‚„äº”æ„Ÿæå†™ã‚‚ã‚°ãƒ©ãƒ•åŒ–ã—ã¾ã™ã€‚">
    <meta property="og:site_name" content="Narou Analyzer Pro">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="canonical" href="https://your-domain.com/">
    <link rel="icon" href="/favicon.ico">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Narou Analyzer Pro",
      "url": "https://your-domain.com/",
      "description": "Webå°èª¬ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ã‚¸ãƒ£ãƒ³ãƒ«ã”ã¨ã®é©æ­£ã‚’åˆ†æã—ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "All",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "JPY" }
    }
    </script>

    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@3.9.4/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=BIZ+UDGothic:wght@400;700&family=Zen+Maru+Gothic:wght@500;700&display=swap');
        
        body { font-family: 'Zen Maru Gothic', sans-serif; transition: background-color 0.3s, color 0.3s; }
        .font-mono-jp { font-family: 'BIZ UDGothic', monospace; }
        
        [v-cloak] { display: none; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        [data-theme="night"] .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="min-h-screen bg-base-200 flex flex-col">

<div id="app" v-cloak class="flex-grow">
    <header class="navbar glass-panel sticky top-0 z-50 shadow-sm px-4">
        <div class="flex-1">
            <h1 class="text-xl md:text-2xl font-black text-primary flex items-center gap-2 tracking-tighter cursor-pointer" onclick="window.scrollTo(0,0)">
                <i class="ph-fill ph-pen-nib-straight"></i> 
                <span>Narou<span class="hidden md:inline"> Analyzer Pro</span></span>
            </h1>
        </div>
        <div class="flex-none gap-2">
            <button class="btn btn-ghost btn-xs md:btn-sm" onclick="my_modal_2.showModal()">
                <i class="ph-fill ph-shield-check text-success"></i> å®‰å…¨æ€§ã«ã¤ã„ã¦
            </button>
            <label class="swap swap-rotate btn btn-ghost btn-circle btn-sm">
                <input type="checkbox" v-model="isDarkMode" />
                <i class="ph-fill ph-sun swap-on text-yellow-500 text-xl"></i>
                <i class="ph-fill ph-moon swap-off text-indigo-500 text-xl"></i>
            </label>
        </div>
    </header>

    <main class="p-4 md:p-8 max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6 pb-24">
        <section class="lg:col-span-4 space-y-4">
            <div class="card bg-base-100 shadow-lg">
                <div class="card-body p-4">
                    <label class="label pt-0"><span class="label-text font-bold text-gray-500">åŸ·ç­†ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸æŠ</span></label>
                    <select v-model="selectedGenre" class="select select-bordered w-full select-sm md:select-md font-bold">
                        <template v-for="(subGenres, mainGenre) in genreDefinitions" :key="mainGenre">
                            <optgroup :label="mainGenre">
                                <option v-for="sub in subGenres" :value="sub.id">{{ sub.name }}</option>
                            </optgroup>
                        </template>
                    </select>
                    <div class="text-xs text-gray-400 mt-1 flex items-center gap-1">
                        <i class="ph-fill ph-info"></i> <span>{{ currentGenreSettings.description }}</span>
                    </div>
                </div>
            </div>

            <div class="card bg-base-100 shadow-xl border-t-4 border-primary">
                <div class="card-body p-4 md:p-6">
                    <div class="flex justify-between items-end mb-2">
                        <h2 class="text-sm font-bold text-gray-500 uppercase tracking-wider">æœ¬æ–‡å…¥åŠ›</h2>
                        <span class="text-xs badge" :class="inputText.length > 0 ? 'badge-primary' : 'badge-ghost'">{{ inputText.length.toLocaleString() }} chars</span>
                    </div>
                    <textarea v-model="inputText" class="textarea textarea-bordered w-full h-[40vh] lg:h-[60vh] font-mono-jp text-base leading-8 resize-none focus:outline-none focus:border-primary transition-all" :class="{'bg-gray-50 text-gray-800': !isDarkMode, 'bg-gray-800 text-gray-100': isDarkMode}" placeholder="ã“ã“ã«å°èª¬ã®æœ¬æ–‡ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚&#10;â€»ãƒ‡ãƒ¼ã‚¿ã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œãšã€ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®‰å…¨ã«è§£æã•ã‚Œã¾ã™ã€‚"></textarea>
                </div>
            </div>
        </section>

        <section class="lg:col-span-8 space-y-6" id="results-area">
            <div v-if="!stats" class="flex flex-col h-full min-h-[400px]">
                <div class="flex-1 flex flex-col items-center justify-center text-base-content/30 border-2 border-dashed border-base-300 rounded-box p-8 mb-6">
                    <i class="ph ph-brain text-6xl mb-4 animate-pulse"></i>
                    <p class="text-lg font-bold">AIæ–‡ä½“è¨ºæ–­ & æ„Ÿæƒ…åˆ†æ</p>
                    <p class="text-sm mt-2">å…¥åŠ›ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã¯å¤–éƒ¨ã«æµå‡ºã—ã¾ã›ã‚“</p>
                </div>
                <article class="prose prose-sm md:prose max-w-none bg-base-100 p-6 rounded-xl shadow-sm">
                    <h3>ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦</h3>
                    <p>Webå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆï¼ˆå°èª¬å®¶ã«ãªã‚ã†ã€ã‚«ã‚¯ãƒ¨ãƒ ç­‰ï¼‰ã§ã®äººæ°—ä½œå“å‚¾å‘ã«åŸºã¥ãã€ã‚ãªãŸã®å°èª¬ã‚’è§£æãƒ»ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚</p>
                    <ul>
                        <li><strong>ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥æœ€é©åŒ–:</strong> ç•°ä¸–ç•Œã€ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã€æ‹æ„›ãªã©é¸æŠã—ãŸã‚¸ãƒ£ãƒ³ãƒ«ã«åˆã‚ã›ã¦åŸºæº–ã‚’å¤‰æ›´ã€‚</li>
                        <li><strong>æ„Ÿæƒ…æ›²ç·šåˆ†æ:</strong> ç‰©èªã®èµ·æ‰¿è»¢çµã«ãŠã‘ã‚‹æ„Ÿæƒ…ã®ç››ã‚Šä¸ŠãŒã‚Šã‚’ã‚°ãƒ©ãƒ•åŒ–ã€‚</li>
                        <li><strong>äº”æ„Ÿæå†™ãƒã‚§ãƒƒã‚¯:</strong> æ²¡å…¥æ„Ÿã‚’é«˜ã‚ã‚‹ãŸã‚ã®æå†™ãƒãƒ©ãƒ³ã‚¹ã‚’åˆ¤å®šã€‚</li>
                    </ul>
                </article>
            </div>

            <div v-if="stats" class="space-y-6 animate-fade-in-up">
                
                <div class="card bg-base-100 shadow-xl overflow-hidden">
                    <div class="absolute top-0 left-0 w-2 h-full" :class="rankColorClass"></div>
                    <div class="card-body p-5 md:p-8">
                        <div class="flex flex-col md:flex-row gap-6 items-center">
                            <div class="text-center md:text-left min-w-[120px]">
                                <div class="text-xs text-gray-400 font-bold mb-1">ç·åˆãƒ©ãƒ³ã‚¯</div>
                                <div class="text-8xl font-black leading-none bg-clip-text text-transparent bg-gradient-to-br" :class="rankGradient">{{ stats.rank }}</div>
                                <div class="badge badge-lg mt-2 font-bold w-full shadow-sm" :class="rankBadgeColor">{{ stats.title }}</div>
                            </div>
                            <div class="flex-1 w-full bg-base-200/50 p-4 rounded-xl border border-base-300 relative">
                                <i class="ph-fill ph-quotes text-4xl absolute -top-3 -left-2 text-base-content/10"></i>
                                <h3 class="font-bold text-sm mb-2 flex items-center gap-2"><i class="ph-fill ph-robot text-primary"></i> AIè¬›è©•</h3>
                                <p class="text-sm md:text-base leading-relaxed opacity-90 whitespace-pre-line">{{ stats.comment }}</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-6 pt-6 border-t border-base-200">
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-1">ã‚¸ãƒ£ãƒ³ãƒ«ä¸€è‡´åº¦</div>
                                <div class="font-bold text-xl">{{ stats.contentMetrics.genreMatch }}<span class="text-xs font-normal">%</span></div>
                            </div>
                            <div class="text-center border-l border-base-200">
                                <div class="text-xs text-gray-500 mb-1">äº”æ„Ÿæå†™</div>
                                <div class="font-bold text-xl" :class="stats.contentMetrics.sensoryScore > 5 ? 'text-secondary' : ''">Lv.{{ stats.contentMetrics.sensoryScore }}</div>
                            </div>
                            <div class="text-center border-l border-base-200">
                                <div class="text-xs text-gray-500 mb-1">å¯èª­æ€§ã‚¹ã‚³ã‚¢</div>
                                <div class="font-bold text-xl">{{ stats.metrics[1].toFixed(0) }}<span class="text-xs font-normal">pt</span></div>
                            </div>
                            <div class="text-center border-l border-base-200">
                                <div class="text-xs text-gray-500 mb-1">æ„Ÿæƒ…èµ·ä¼</div>
                                <div class="font-bold text-xl text-accent">{{ stats.contentMetrics.emotionalRange }}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button @click="shareToX" class="btn btn-neutral text-white shadow-lg w-full transform transition hover:scale-[1.02]">
                        <svg class="w-5 h-5 fill-current" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                        <span>çµæœã‚’ãƒã‚¹ãƒˆã™ã‚‹</span>
                    </button>
                    <button @click="copyResult" class="btn btn-outline bg-base-100 shadow-md w-full">
                        <i class="ph-bold ph-copy"></i>
                        <span>çµæœã‚’ã‚³ãƒ”ãƒ¼</span>
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card bg-base-100 shadow-lg md:col-span-2">
                        <div class="card-body p-4">
                            <h3 class="font-bold text-sm text-gray-500 flex items-center gap-2"><i class="ph-fill ph-heartbeat text-pink-500"></i> ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®æ„Ÿæƒ…æ›²ç·š</h3>
                            <div class="relative w-full h-[200px]"><canvas id="sentimentChart"></canvas></div>
                        </div>
                    </div>
                    <div class="card bg-base-100 shadow-lg">
                        <div class="card-body p-4">
                            <h3 class="font-bold text-sm text-gray-500 flex items-center gap-2"><i class="ph-fill ph-radar"></i> ç·åˆãƒãƒ©ãƒ³ã‚¹åˆ†æ</h3>
                            <div class="relative w-full aspect-square md:aspect-video lg:aspect-square"><canvas id="radarChart"></canvas></div>
                        </div>
                    </div>
                    <div class="card bg-base-100 shadow-lg">
                        <div class="card-body p-4">
                            <h3 class="font-bold text-sm text-gray-500 flex items-center gap-2"><i class="ph-fill ph-eye text-teal-500"></i> äº”æ„Ÿæå†™ & ã‚¸ãƒ£ãƒ³ãƒ«ãƒ¯ãƒ¼ãƒ‰</h3>
                            <div class="space-y-4 mt-2">
                                <div><div class="flex justify-between text-xs mb-1"><span>è¦–è¦š</span><span class="font-bold text-teal-600">Sight</span></div><progress class="progress progress-accent w-full" :value="Math.min(100, stats.contentMetrics.senses.sight * 20)" max="100"></progress></div>
                                <div><div class="flex justify-between text-xs mb-1"><span>è´è¦š</span><span class="font-bold text-blue-600">Sound</span></div><progress class="progress progress-info w-full" :value="Math.min(100, stats.contentMetrics.senses.sound * 20)" max="100"></progress></div>
                                <div><div class="flex justify-between text-xs mb-1"><span>è§¦è¦š</span><span class="font-bold text-orange-600">Touch</span></div><progress class="progress progress-warning w-full" :value="Math.min(100, stats.contentMetrics.senses.touch * 20)" max="100"></progress></div>
                                <div class="bg-base-200 p-3 rounded-lg mt-4">
                                    <div class="text-xs font-bold text-gray-500 mb-2">æ¤œå‡ºã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</div>
                                    <div class="flex flex-wrap gap-1">
                                        <span v-for="word in stats.contentMetrics.foundKeywords" :key="word" class="badge badge-sm badge-outline bg-base-100">{{ word }}</span>
                                        <span v-if="stats.contentMetrics.foundKeywords.length === 0" class="text-xs text-gray-400">ç‰¹ã«ãªã—</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card bg-base-100 shadow-xl">
                    <div class="card-body p-0 md:p-6">
                        <div class="p-4 md:p-0"><h3 class="card-title text-base"><i class="ph-fill ph-check-circle text-success"></i> æ”¹å–„ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h3></div>
                        <div class="overflow-x-auto">
                            <table class="table table-zebra w-full text-sm">
                                <thead class="bg-base-200">
                                    <tr><th>é …ç›®</th><th class="text-center">ç¾çŠ¶</th><th class="hidden md:table-cell">ç›®æ¨™ç›®å®‰</th><th>ã‚¢ãƒ‰ãƒã‚¤ã‚¹</th></tr>
                                </thead>
                                <tbody>
                                    <tr v-for="item in adviceList" :key="item.label">
                                        <td class="font-bold whitespace-nowrap">{{ item.label }}</td>
                                        <td class="text-center font-mono font-bold" :class="item.statusColor">{{ item.value }}</td>
                                        <td class="hidden md:table-cell text-gray-500 text-xs">{{ item.target }}</td>
                                        <td><span class="badge badge-sm border-0" :class="item.badge">{{ item.msg }}</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer footer-center p-4 bg-base-300 text-base-content">
        <aside><p class="font-bold text-xs md:text-sm">&copy; 2024 Narou Analyzer Pro. Powered by Vue.js & Chart.js.</p></aside>
    </footer>

    <div class="fixed bottom-4 left-0 right-0 px-4 z-40 flex flex-col gap-2 items-center pointer-events-none">
        <div v-if="toastMessage" class="alert shadow-lg w-auto min-w-[300px] animate-bounce-in pointer-events-auto" :class="toastType">
            <i class="ph-fill text-xl" :class="toastIcon"></i><span>{{ toastMessage }}</span>
        </div>
        <button @click="analyzeText" :disabled="isProcessing || inputText.length < 10" class="btn btn-primary btn-lg w-full max-w-md shadow-xl border-t border-white/20 pointer-events-auto transition-all transform active:scale-95" :class="{'btn-disabled opacity-50': inputText.length < 10}">
            <span v-if="isProcessing" class="loading loading-spinner"></span>
            <span v-else class="flex items-center gap-2"><i class="ph-bold ph-lightning"></i><span>{{ getGenreName(selectedGenre) }}åŸºæº–ã§è§£æ</span></span>
        </button>
    </div>
</div>

<dialog id="my_modal_2" class="modal">
  <div class="modal-box">
    <h3 class="font-bold text-lg text-success flex items-center gap-2"><i class="ph-fill ph-lock-key"></i> ãƒ‡ãƒ¼ã‚¿ä¿è­·ã«ã¤ã„ã¦</h3>
    <p class="py-4"><strong>1. ã‚µãƒ¼ãƒãƒ¼ã¸ã®é€ä¿¡ãªã—</strong><br>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãŒã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ãƒ»ä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    <div class="modal-action"><form method="dialog"><button class="btn">é–‰ã˜ã‚‹</button></form></div>
  </div>
  <form method="dialog" class="modal-backdrop"><button>close</button></form>
</dialog>

<script>
    const DICTIONARIES = {
        positive: ['å¥½ã', 'æ„›', 'å¬‰ã—ã„', 'æ¥½ã—ã„', 'å¹¸ã›', 'å…‰', 'ç¬‘é¡”', 'å¸Œæœ›', 'æˆåŠŸ', 'ç¾ã—ã„', 'æœ€é«˜', 'å®‰å¿ƒ', 'æ¸©ã‹ã„', 'å–œã³', 'å‹åˆ©', 'ç´ æ•µ', 'ã‚ã‚ŠãŒã¨ã†', 'ä»²é–“', 'çµ†', 'å›å¾©', 'æ•‘ã„', 'å„ªé›…', 'å¯æ†', 'çˆ½å¿«'],
        negative: ['å«Œã„', 'æ†', 'æ‚²ã—ã„', 'è¾›ã„', 'è‹¦ã—ã„', 'é—‡', 'æ¶™', 'çµ¶æœ›', 'å¤±æ•—', 'é†œã„', 'æœ€æ‚ª', 'ä¸å®‰', 'å†·ãŸã„', 'æ€’ã‚Š', 'æ•—åŒ—', 'æ­»', 'æ®º', 'ç—›ã„', 'æ€–ã„', 'ææ€–', 'å­¤ç‹¬', 'è£åˆ‡ã‚Š', 'å«ã³', 'è¡€', 'å‚·'],
        sight: ['è¦‹ã‚‹', 'è¦‹ãˆ', 'è¦–ç·š', 'è‰²', 'èµ¤', 'é’', 'é»’', 'ç™½', 'è¼', 'æš—', 'å…‰', 'å§¿', 'æ™¯è‰²', 'ç³', 'é®®ã‚„ã‹', 'ã¼ã‚“ã‚„ã‚Š', 'æ˜ ã‚‹'],
        sound: ['è', 'éŸ³', 'å£°', 'éŸ¿', 'é™å¯‚', 'å«', 'å›', 'æ­Œ', 'é¨’', 'è€³', 'è½Ÿ', 'ãƒ¡ãƒ­ãƒ‡ã‚£', 'æ‚²é³´', 'ã–ã‚'],
        touch: ['ç—›', 'ç†±', 'å†·', 'è§¦', 'è‚Œ', 'éœ‡', 'é‡', 'è»½', 'ç¡¬', 'æŸ”', 'é¢¨', 'æ’«', 'æ®´', 'ä½“æ¸©', 'ç—º'],
        genres: {
            isekai: ['é­”æ³•', 'ã‚¹ã‚­ãƒ«', 'ãƒ¬ãƒ™ãƒ«', 'å‰£', 'ã‚®ãƒ«ãƒ‰', 'é­”ç‹', 'å‹‡è€…', 'è»¢ç”Ÿ', 'å¬å–š', 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹', 'ç‹å¥³', 'ä»¤å¬¢', 'å©šç´„ç ´æ£„', 'ç‹å­', 'è²´æ—', 'ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³', 'å†’é™ºè€…', 'é­”ç‰©', 'ãƒ‰ãƒ©ã‚´ãƒ³'],
            real_love: ['å­¦æ ¡', 'æ•™å®¤', 'å…ˆè¼©', 'å¾Œè¼©', 'éƒ¨æ´»', 'æ”¾èª²å¾Œ', 'ãƒ‡ãƒ¼ãƒˆ', 'å‘Šç™½', 'æºå¸¯', 'ã‚¹ãƒãƒ›', 'ä»•äº‹', 'ä¼šç¤¾', 'çµå©š', 'é›¢å©š', 'æµ®æ°—', 'å½¼æ°', 'å½¼å¥³', 'æ‹äºº'],
            high_fantasy: ['å‰£', 'é­”æ³•', 'ãƒ‰ãƒ©ã‚´ãƒ³', 'ã‚¨ãƒ«ãƒ•', 'ãƒ‰ãƒ¯ãƒ¼ãƒ•', 'ç‹å›½', 'å¸å›½', 'ç²¾éœŠ', 'ç¥', 'å‘ªã„', 'åŸ', 'é¨å£«', 'æ£®', 'æ—…', 'ä¼èª¬'],
            mystery: ['æ®ºäºº', 'æ­»ä½“', 'è­¦å¯Ÿ', 'åˆ‘äº‹', 'æ¢åµ', 'è¨¼æ‹ ', 'ãƒˆãƒªãƒƒã‚¯', 'çŠ¯äºº', 'å¯†å®¤', 'å‹•æ©Ÿ', 'ã‚¢ãƒªãƒã‚¤', 'äº‹ä»¶', 'æ¨ç†', 'è¬'],
            horror: ['è¡€', 'æ­»', 'å‘ª', 'éœŠ', 'å¹½éœŠ', 'é—‡', 'æ‚²é³´', 'ææ€–', 'æ®º', 'é€ƒ', 'ç‹‚', 'å½±', 'åŒ–ã‘ç‰©', 'å»ƒå¢Ÿ', 'å¤œ'],
            scifi: ['å®‡å®™', 'ãƒ­ãƒœãƒƒãƒˆ', 'AI', 'èˆ¹', 'æ˜Ÿ', 'æœªæ¥', 'ç§‘å­¦', 'å®Ÿé¨“', 'åšå£«', 'æ©Ÿæ¢°', 'ã‚·ã‚¹ãƒ†ãƒ ', 'ãƒ‡ãƒ¼ã‚¿', 'ä»®æƒ³', 'VR', 'ãƒ¬ãƒ¼ã‚¶ãƒ¼']
        }
    };
    
    const GENRE_PARAMS = {
        'isekai':       { name: 'ç•°ä¸–ç•Œ(æ‹æ„›)', type: 'light', keywords: 'isekai', desc: 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼šå©šç´„ç ´æ£„ã€é­”æ³•ã€ã‚¹ã‚­ãƒ«ç­‰' },
        'real_love':    { name: 'ç¾å®Ÿä¸–ç•Œ(æ‹æ„›)', type: 'std', keywords: 'real_love', desc: 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼šå­¦æ ¡ã€ã‚ªãƒ•ã‚£ã‚¹ã€å‘Šç™½ç­‰' },
        'high_fantasy': { name: 'ãƒã‚¤ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼', type: 'light', keywords: 'high_fantasy', desc: 'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼šå‰£ã€é­”æ³•ã€å†’é™ºç­‰' },
        'low_fantasy':  { name: 'ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼', type: 'std', keywords: 'isekai', desc: 'ç¾ä»£çŸ¥è­˜Ã—ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼è¦ç´ ' },
        'pure_lit':     { name: 'ç´”æ–‡å­¦', type: 'heavy', keywords: null, desc: 'æ„Ÿæƒ…æå†™ã¨é¢¨æ™¯æå†™ã®æ·±ã•ã‚’è©•ä¾¡' },
        'human':        { name: 'ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ', type: 'std', keywords: 'real_love', desc: 'äººé–“é–¢ä¿‚ã®æ©Ÿå¾®ã‚’è©•ä¾¡' },
        'history':      { name: 'æ­´å²', type: 'heavy', keywords: 'high_fantasy', desc: 'æ™‚ä»£èƒŒæ™¯ã®æå†™ã‚’è©•ä¾¡' },
        'mystery':      { name: 'æ¨ç†', type: 'heavy', keywords: 'mystery', desc: 'è¬è§£ãè¦ç´ ã€äº‹ä»¶æ€§ã‚’è©•ä¾¡' },
        'horror':       { name: 'ãƒ›ãƒ©ãƒ¼', type: 'std', keywords: 'horror', desc: 'ææ€–æ¼”å‡ºã€äº”æ„Ÿã¸ã®åˆºæ¿€ã‚’è©•ä¾¡' },
        'action':       { name: 'ã‚¢ã‚¯ã‚·ãƒ§ãƒ³', type: 'std', keywords: 'high_fantasy', desc: 'æˆ¦é—˜æå†™ã®ã‚¹ãƒ”ãƒ¼ãƒ‰æ„Ÿã‚’è©•ä¾¡' },
        'comedy':       { name: 'ã‚³ãƒ¡ãƒ‡ã‚£ãƒ¼', type: 'light', keywords: null, desc: 'ãƒ†ãƒ³ãƒã®è‰¯ã•ã‚’æœ€å„ªå…ˆ' },
        'vr_game':      { name: 'VRã‚²ãƒ¼ãƒ ', type: 'light', keywords: 'scifi', desc: 'ã‚²ãƒ¼ãƒ ç”¨èªã€ã‚·ã‚¹ãƒ†ãƒ æå†™' },
        'space':        { name: 'å®‡å®™(SF)', type: 'std', keywords: 'scifi', desc: 'SFã‚¬ã‚¸ã‚§ãƒƒãƒˆã€ä¸–ç•Œè¦³ç”¨èª' },
        'scifi':        { name: 'ç©ºæƒ³ç§‘å­¦', type: 'std', keywords: 'scifi', desc: 'ç§‘å­¦çš„ç”¨èªã€ç†è«–' },
        'panic':        { name: 'ãƒ‘ãƒ‹ãƒƒã‚¯', type: 'light', keywords: 'horror', desc: 'åˆ‡è¿«æ„Ÿã€å±æ©Ÿçš„çŠ¶æ³' },
        'fairy':        { name: 'ç«¥è©±', type: 'special', keywords: null, desc: 'å¹³æ˜“ãªè¡¨ç¾' },
        'essay':        { name: 'ã‚¨ãƒƒã‚»ã‚¤', type: 'special', keywords: null, desc: 'å€‹äººã®æ€æƒ³è¡¨ç¾' },
        'poetry':       { name: 'è©©', type: 'special', keywords: null, desc: 'ãƒªã‚ºãƒ ã¨æ„Ÿæ€§' },
        'replay':       { name: 'ãƒªãƒ—ãƒ¬ã‚¤', type: 'special', keywords: null, desc: 'ä¼šè©±è¨˜éŒ²' },
        'other':        { name: 'ãã®ä»–', type: 'std', keywords: null, desc: 'æ¨™æº–çš„ãªè§£æ' }
    };

    const SCORING_PROFILES = {
        light: { targetLen: 35, lenPenalty: 2.0, minBlank: 15, minDialog: 30, maxKanji: 30 },
        std: { targetLen: 45, lenPenalty: 1.5, minBlank: 10, minDialog: 20, maxKanji: 40 },
        heavy: { targetLen: 60, lenPenalty: 1.0, minBlank: 5, minDialog: 5, maxKanji: 50 },
        special: { targetLen: 50, lenPenalty: 0.5, minBlank: 10, minDialog: 0, maxKanji: 40 }
    };

    const { createApp, ref, computed, watch, nextTick } = Vue;

    createApp({
        setup() {
            const inputText = ref('');
            const selectedGenre = ref('isekai');
            const isProcessing = ref(false);
            const stats = ref(null);
            const adviceList = ref([]);
            const isDarkMode = ref(false);
            const toastMessage = ref('');
            const toastType = ref('alert-info');
            let radarChart = null;
            let sentimentChart = null;

            const genreDefinitions = {
                'æ‹æ„›': [ { id: 'isekai', name: 'ç•°ä¸–ç•Œ' }, { id: 'real_love', name: 'ç¾å®Ÿä¸–ç•Œ' } ],
                'ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼': [ { id: 'high_fantasy', name: 'ãƒã‚¤ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼' }, { id: 'low_fantasy', name: 'ãƒ­ãƒ¼ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼' } ],
                'æ–‡èŠ¸': [ { id: 'pure_lit', name: 'ç´”æ–‡å­¦' }, { id: 'human', name: 'ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ' }, { id: 'history', name: 'æ­´å²' }, { id: 'mystery', name: 'æ¨ç†' }, { id: 'horror', name: 'ãƒ›ãƒ©ãƒ¼' }, { id: 'action', name: 'ã‚¢ã‚¯ã‚·ãƒ§ãƒ³' }, { id: 'comedy', name: 'ã‚³ãƒ¡ãƒ‡ã‚£ãƒ¼' } ],
                'SF': [ { id: 'vr_game', name: 'VRã‚²ãƒ¼ãƒ ' }, { id: 'space', name: 'å®‡å®™' }, { id: 'scifi', name: 'ç©ºæƒ³ç§‘å­¦' }, { id: 'panic', name: 'ãƒ‘ãƒ‹ãƒƒã‚¯' } ],
                'ãã®ä»–': [ { id: 'fairy', name: 'ç«¥è©±' }, { id: 'poetry', name: 'è©©' }, { id: 'essay', name: 'ã‚¨ãƒƒã‚»ã‚¤' }, { id: 'replay', name: 'ãƒªãƒ—ãƒ¬ã‚¤' }, { id: 'other', name: 'ãã®ä»–' } ]
            };

            watch(isDarkMode, (newVal) => {
                document.documentElement.setAttribute('data-theme', newVal ? 'night' : 'winter');
                updateChartTheme();
            });

            const currentGenreSettings = computed(() => GENRE_PARAMS[selectedGenre.value] || GENRE_PARAMS['other']);
            const getGenreName = (id) => (GENRE_PARAMS[id] || GENRE_PARAMS['other']).name;
            const showToast = (msg, type = 'alert-info') => {
                toastMessage.value = msg;
                toastType.value = type;
                setTimeout(() => { toastMessage.value = ''; }, 3000);
            };
            const toastIcon = computed(() => {
                if (toastType.value.includes('success')) return 'ph-check-circle';
                if (toastType.value.includes('error')) return 'ph-warning-circle';
                return 'ph-info';
            });
            const calculateMean = (arr) => arr.reduce((a, b) => a + b, 0) / (arr.length || 1);

            // Analysis Core
            const analyzeContent = (tokens, genreKey) => {
                let posScore = 0, negScore = 0, sightCount = 0, soundCount = 0, touchCount = 0, genreMatchCount = 0;
                const foundKeywords = new Set();
                const sentimentTimeline = [];
                let currentChunkScore = 0;
                const chunkSize = Math.ceil(tokens.length / 20);
                const targetGenreKey = GENRE_PARAMS[genreKey].keywords;
                const genreWords = targetGenreKey ? DICTIONARIES.genres[targetGenreKey] : [];

                tokens.forEach((token, index) => {
                    let val = 0;
                    if (DICTIONARIES.positive.some(w => token.includes(w))) { posScore++; val = 1; }
                    if (DICTIONARIES.negative.some(w => token.includes(w))) { negScore++; val = -1; }
                    if (DICTIONARIES.sight.some(w => token.includes(w))) sightCount++;
                    if (DICTIONARIES.sound.some(w => token.includes(w))) soundCount++;
                    if (DICTIONARIES.touch.some(w => token.includes(w))) touchCount++;
                    if (genreWords && genreWords.some(w => token.includes(w))) { genreMatchCount++; foundKeywords.add(token); }

                    currentChunkScore += val;
                    if ((index + 1) % chunkSize === 0 || index === tokens.length - 1) {
                        sentimentTimeline.push(currentChunkScore);
                        currentChunkScore = 0;
                    }
                });

                const smoothedTimeline = sentimentTimeline.map((val, i, arr) => {
                    const prev = arr[i-1] || val;
                    const next = arr[i+1] || val;
                    return (prev + val + next) / 3;
                });

                const sensoryScore = Math.min(10, Math.ceil((sightCount + soundCount + touchCount) * 100 / tokens.length));
                let genreMatchScore = 100;
                if (genreWords.length > 0) {
                    const matchRatio = (genreMatchCount / tokens.length) * 1000;
                    genreMatchScore = Math.min(100, 50 + matchRatio * 10);
                }
                const range = Math.max(...smoothedTimeline) - Math.min(...smoothedTimeline);
                
                return {
                    sentimentTimeline: smoothedTimeline,
                    senses: { sight: sightCount, sound: soundCount, touch: touchCount },
                    sensoryScore, genreMatchScore,
                    foundKeywords: Array.from(foundKeywords).slice(0, 8),
                    emotionalRange: range > 5 ? 'ãƒ‰ãƒ©ãƒãƒãƒƒã‚¯' : range > 2 ? 'æ¨™æº–çš„' : 'å¹³å¦',
                    rawRange: range
                };
            };

            const analyzeText = async () => {
                if (inputText.value.length < 10) return;
                isProcessing.value = true;
                await new Promise(r => setTimeout(r, 500));

                try {
                    const text = inputText.value;
                    const genreKey = selectedGenre.value;
                    const params = SCORING_PROFILES[GENRE_PARAMS[genreKey].type];

                    let tokens = [];
                    if (window.Intl && Intl.Segmenter) {
                        const segmenter = new Intl.Segmenter('ja', { granularity: 'word' });
                        for (const seg of segmenter.segment(text)) { if (seg.isWordLike) tokens.push(seg.segment); }
                    } else { tokens = text.split(/[\s\u3000ã€ã€‚ï¼ï¼Ÿ\(\)ã€Œã€]+/); }
                    const ttr = tokens.length > 0 ? ((new Set(tokens).size / tokens.length) * 100).toFixed(1) : 0;

                    const lines = text.split('\n');
                    const sentences = text.split(/[ã€‚ï¼ï¼Ÿ]/).filter(s => s.trim().length > 0);
                    const avgLen = calculateMean(sentences.map(s => s.length));
                    const blankRatio = (lines.filter(l => l.trim() === '').length / lines.length) * 100;
                    const dialogueRatio = ((text.match(/ã€Œ[^ã€]+ã€/g) || []).join('').length / text.length) * 100;
                    const kanjiRatio = ((text.match(/[\u4E00-\u9FFF]/g) || []).length / (text.replace(/\s/g,'').length || 1)) * 100;

                    const cMetrics = analyzeContent(tokens, genreKey);

                    let readScore = Math.max(0, Math.min(100, 100 - Math.max(0, (avgLen - params.targetLen) * params.lenPenalty) - Math.max(0, (params.minBlank - blankRatio) * 2)));
                    let immScore = Math.max(0, Math.min(100, 100 - (dialogueRatio < params.minDialog ? (params.minDialog - dialogueRatio) * 2 : 0)));
                    let contScore = Math.max(0, Math.min(100, 60 + cMetrics.rawRange * 5 - (cMetrics.genreMatchScore < 60 ? 10 : 0) - (cMetrics.sensoryScore < 2 ? 10 : 0)));
                    let formScore = (kanjiRatio <= params.maxKanji ? 50 : Math.max(0, 50 - (kanjiRatio - params.maxKanji)*2)) + (avgLen <= params.targetLen ? 50 : Math.max(0, 50 - (avgLen - params.targetLen)*1.5));
                    
                    const totalScore = (readScore + immScore + contScore + formScore) / 4;
                    let rank = totalScore >= 85 ? 'S' : totalScore >= 70 ? 'A' : totalScore >= 55 ? 'B' : 'C';
                    let title = totalScore >= 85 ? 'ãƒã‚¹ã‚¿ãƒ¼ãƒ”ãƒ¼ã‚¹' : totalScore >= 70 ? 'è‰¯ä½œ' : totalScore >= 55 ? 'æ¨™æº–' : 'è¦æ”¹å–„';
                    let comment = totalScore >= 85 ? `ç´ æ™´ã‚‰ã—ã„ï¼${getGenreName(genreKey)}ã¨ã—ã¦å®Œç’§ãªãƒãƒ©ãƒ³ã‚¹ã§ã™ã€‚` : 
                                  totalScore >= 70 ? `è‰¯ã„å‡ºæ¥ã§ã™ã€‚${cMetrics.emotionalRange}ãªå±•é–‹ãŒè©•ä¾¡ã•ã‚Œã¦ã„ã¾ã™ã€‚` : 
                                  totalScore >= 55 ? `åŸºæœ¬ã¯ã§ãã¦ã„ã¾ã™ã€‚${cMetrics.rawRange < 2 ? 'èµ·ä¼ã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚' : 'ãƒãƒ©ãƒ³ã‚¹ã‚’è¦‹ç›´ã—ã¾ã—ã‚‡ã†ã€‚'}` : 
                                  `æ§‹æˆã‹å†…å®¹ã«èª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`;

                    stats.value = { rank, title, comment, metrics: [formScore, readScore, immScore, contScore, parseFloat(ttr)], contentMetrics: cMetrics };
                    
                    const list = [];
                    const isGenreLow = cMetrics.genreMatchScore < 70 && GENRE_PARAMS[genreKey].keywords;
                    list.push({ label: 'ã‚¸ãƒ£ãƒ³ãƒ«æ€§', value: cMetrics.genreMatchScore >= 80 ? 'é«˜ã„' : 'æ™®é€š', target: 'é–¢é€£èªå¥ã®ä½¿ç”¨', statusColor: isGenreLow ? 'text-warning' : 'text-success', badge: isGenreLow ? 'badge-warning' : 'badge-success', msg: isGenreLow ? 'ã‚¸ãƒ£ãƒ³ãƒ«ç‰¹æœ‰ã®å˜èªãŒå°‘ãªã‚ã§ã™ã€‚' : 'ã‚¸ãƒ£ãƒ³ãƒ«ã«åˆã£ã¦ã„ã¾ã™ã€‚' });
                    const isSensoryLow = cMetrics.sensoryScore < 3;
                    list.push({ label: 'äº”æ„Ÿæå†™', value: 'Lv.' + cMetrics.sensoryScore, target: 'Lv.3ä»¥ä¸Šæ¨å¥¨', statusColor: isSensoryLow ? 'text-error' : 'text-success', badge: isSensoryLow ? 'badge-error' : 'badge-success', msg: isSensoryLow ? 'æå†™ã‚’è¶³ã—ã¾ã—ã‚‡ã†ã€‚' : 'æƒ…æ™¯ãŒæµ®ã‹ã³ã¾ã™ã€‚' });
                    list.push({ label: 'å¹³å‡æ–‡é•·', value: Math.round(avgLen) + 'æ–‡å­—', target: `${params.targetLen}æ–‡å­—ä»¥ä¸‹`, statusColor: avgLen > params.targetLen + 10 ? 'text-error' : 'text-success', badge: avgLen > params.targetLen + 10 ? 'badge-error' : 'badge-ghost', msg: avgLen > params.targetLen + 10 ? 'é•·ã™ãã¾ã™ã€‚' : 'é©æ­£ã§ã™ã€‚' });
                    adviceList.value = list;

                    showToast('è§£æå®Œäº†ï¼', 'alert-success');
                    await nextTick();
                    renderCharts();
                    document.getElementById('results-area').scrollIntoView({ behavior: 'smooth', block: 'start' });
                } catch (e) { console.error(e); showToast('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'alert-error'); } finally { isProcessing.value = false; }
            };

            // Charts
            const updateChartTheme = () => {
                const color = isDarkMode.value ? '#cbd5e1' : '#475569';
                const grid = isDarkMode.value ? '#334155' : '#e2e8f0';
                [radarChart, sentimentChart].forEach(c => {
                    if(c) {
                        if(c.options.scales.r) c.options.scales.r.pointLabels.color = color;
                        if(c.options.scales.y) { c.options.scales.y.grid.color = grid; c.options.scales.y.ticks.color = color; }
                        c.update();
                    }
                });
            };

            const renderCharts = () => {
                if (radarChart) radarChart.destroy();
                if (sentimentChart) sentimentChart.destroy();
                const ctxR = document.getElementById('radarChart'), ctxS = document.getElementById('sentimentChart');
                if(!ctxR || !ctxS) return;
                const color = isDarkMode.value ? '#cbd5e1' : '#475569';
                const grid = isDarkMode.value ? '#334155' : '#e2e8f0';

                radarChart = new Chart(ctxR, {
                    type: 'radar',
                    data: { labels: ['å½¢å¼ç‚¹', 'å¯èª­æ€§', 'ä¼šè©±ãƒ»æ²¡å…¥', 'å†…å®¹ãƒ»å±•é–‹', 'èªå½™åŠ›'], datasets: [{ label: 'è©•ä¾¡ã‚¹ã‚³ã‚¢', data: stats.value.metrics, backgroundColor: 'rgba(255, 99, 132, 0.2)', borderColor: '#ff6384', borderWidth: 2, pointBackgroundColor: '#ff6384' }] },
                    options: { responsive: true, maintainAspectRatio: false, scales: { r: { min: 0, max: 100, ticks: { display: false }, grid: { color: grid }, pointLabels: { color: color, font: { size: 12 } } } }, plugins: { legend: { display: false } } }
                });

                sentimentChart = new Chart(ctxS, {
                    type: 'line',
                    data: { labels: stats.value.contentMetrics.sentimentTimeline.map((_, i) => i === 0 ? 'åºç›¤' : i === stats.value.contentMetrics.sentimentTimeline.length-1 ? 'çµæœ«' : ''), datasets: [{ label: 'æ„Ÿæƒ…å€¤', data: stats.value.contentMetrics.sentimentTimeline, borderColor: '#3b82f6', backgroundColor: (ctx) => { const g = ctx.chart.ctx.createLinearGradient(0,0,0,200); g.addColorStop(0,'rgba(59,130,246,0.5)'); g.addColorStop(1,'rgba(59,130,246,0.0)'); return g; }, fill: true, tension: 0.4, pointRadius: 0 }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { display: true, grid: { color: grid, drawBorder: false }, ticks: { display: false }, title: { display: true, text: 'ãƒã‚¸ãƒ†ã‚£ãƒ– â‡„ ãƒã‚¬ãƒ†ã‚£ãƒ–', color: color } }, x: { grid: { display: false }, ticks: { color: color } } } }
                });
            };

            // Share Functions
            const shareToX = () => {
                if (!stats.value) return;
                const text = `ã€Webå°èª¬åˆ†æçµæœã€‘\nğŸ–Š ã‚¸ãƒ£ãƒ³ãƒ«ï¼š${getGenreName(selectedGenre.value)}\nğŸ† ãƒ©ãƒ³ã‚¯ï¼š${stats.value.rank}ï¼ˆ${stats.value.title}ï¼‰\nâ¤ï¸ æ„Ÿæƒ…èµ·ä¼ï¼š${stats.value.contentMetrics.emotionalRange}\nâœ¨ äº”æ„Ÿæå†™ï¼šLv.${stats.value.contentMetrics.sensoryScore}\n\nã‚ãªãŸã®å°èª¬ã‚’AIãŒç„¡æ–™è¨ºæ–­ï¼`.trim();
                const url = window.location.href;
                window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}&hashtags=NarouAnalyzerPro,webå°èª¬,åŸ·ç­†`, '_blank');
            };

            const copyResult = async () => {
                if (!stats.value) return;
                const text = `Narou Analyzer Pro è¨ºæ–­çµæœ\nã‚¸ãƒ£ãƒ³ãƒ«ï¼š${getGenreName(selectedGenre.value)}\nç·åˆè©•ä¾¡ï¼š${stats.value.rank} (${stats.value.title})\n\nAIè¬›è©•ï¼š\n${stats.value.comment}\n\n#NarouAnalyzerPro\n${window.location.href}`;
                try { await navigator.clipboard.writeText(text); showToast('çµæœã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ', 'alert-success'); } catch (err) { showToast('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ', 'alert-error'); }
            };

            const rankGradient = computed(() => stats.value ? (stats.value.rank === 'S' ? 'from-amber-400 to-orange-600' : stats.value.rank === 'A' ? 'from-pink-500 to-rose-500' : stats.value.rank === 'B' ? 'from-blue-500 to-cyan-500' : 'from-gray-500 to-gray-700') : '');
            const rankColorClass = computed(() => stats.value ? (stats.value.rank === 'S' ? 'bg-orange-500' : stats.value.rank === 'A' ? 'bg-pink-500' : stats.value.rank === 'B' ? 'bg-info' : 'bg-gray-400') : '');
            const rankBadgeColor = computed(() => stats.value ? (stats.value.rank === 'S' ? 'badge-warning' : stats.value.rank === 'A' ? 'badge-secondary' : stats.value.rank === 'B' ? 'badge-info' : 'badge-ghost') : '');

            return { inputText, isProcessing, stats, adviceList, analyzeText, rankGradient, rankColorClass, rankBadgeColor, isDarkMode, toastMessage, toastType, toastIcon, selectedGenre, genreDefinitions, currentGenreSettings, getGenreName, shareToX, copyResult };
        }
    }).mount('#app');
</script>

<style>
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
    @keyframes bounceIn { 0% { opacity: 0; transform: scale(0.9) translateY(10px); } 70% { opacity: 1; transform: scale(1.05) translateY(-2px); } 100% { opacity: 1; transform: scale(1) translateY(0); } }
    .animate-bounce-in { animation: bounceIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
</style>
</body>
</html>